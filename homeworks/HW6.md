# Домашние задание №5

## Работа с моделью городского полога TEB (Town Energy Balance)

Внимание: выполнение этой части задания предполагается на Google Colab с использованием рабочей папки на Google Drive (необходимо иметь аккаунт).  

В рамках задания необходимо:

* Запустить скрипт сборки и запуска модели TEB [`Lect07_run_TEB`](https://github.com/mvarentsov/UClim4HSE-2025/blob/main/scripts/Lect07_run_TEB.ipynb) в Google Colab с использованием доступных по умолчанию данных для Москвы (`input_Moscow`), убедиться в его штатной работе. В ходе работы скрипта в вашем Google Drive будет создана директория `TEB_open_source_v3_sfx8.1_orig_namelist`, куда будет клонирован репозиторий. Рекомендуется скопировать ее содержимое в другую директорию и далее работать в ней.

* На основе скачанных ранее для [ДЗ №3](https://github.com/mvarentsov/UClim4HSE-2025/blob/main/homeworks/HW3.md) данных реанализа ERA5 подготовить входные данные (метеорологический форсинг) для модели TEB для вашего города, используя скрипт [`Lect07_ERA5_to_TEB`](https://github.com/mvarentsov/UClim4HSE-2025/blob/main/scripts/Lect07_ERA5_to_TEB.ipynb). Полученные текстовые файлы с форсингом нужно скопировать в директорию модели на Google Drivе, например в директорию `input_MyCity`.

* Провести для вашего города **численный эксперимент №1** с настройками модели по-умолчанию. Для этого необходимо указать в неймлисте (конфигурационном файле) модели 'src_driver/namelist_forcing.nml' имя папки с форсингом (`input_MyCity`), географические координаты, дату начала расчета, количество шагов по времени в файлах с форсингом. Результаты расчетов будут записаны в папку `output`.

* Провести **численный эксперимент №2** с уточненными параметрам городской среды. Для этого необходим задать в неймлисте `src_driver/namelist.nml` релевантные для выбранного района города параметры застройки и городской среды (определяются экспертным способом, опираясь на результаты [ДЗ №5](https://github.com/mvarentsov/UClim4HSE-2025/blob/main/homeworks/HW5.md)). Полное описание всех переменных неймлистов доступно [в репозитории TEB](https://github.com/mkolennikova/TEB_open_source_v3_sfx8.1_orig_namelist/blob/main/%D0%9F%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20TEB%20(%D0%BE%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5).xlsx).

* Провести **численный эксперимент №3** для сценария изменения свойств городской среды, направленных на решение какой-либо конкретной проблемы. Примеры возможных сценариев: изменение альбедо поверхности, озеленение, утепление зданий, модификация свойств систем отопления и кондиционирования. Можно рассмотреть несколько сценариев.  

* Проанализировать результаты проведенных численных экспериментов:

    - Сравить значения рассчитанной моделью температуры различных элементов городского каньона (температуры воздуха в каньоне `T_CANYON`, температуры поверхностей `T_ROAD1`, `T_WALLA1`, `T_WALLB1`, `T_ROOF1`, температуры внутри здания `TI_BLD`) в сравнении с температурой воздуха над городом из данных форсинга.
    - Сравить потоки явного и скрытого тепла от города в атмосферу (`H_TOWN`, `LE_TOWN`)
    - Проанализировать затраты энергии на охлаждение и кондиционирование зданий (`HVAC_HEAT`, `HVAC_COOL`)  


**Справка:** модель городского полога TEB (Town Energy Ballance) - первая из городских параметризаций для мезомасштабных моделей атмосферы [(Masson, 2000)](https://link.springer.com/article/10.1023/A:1002463829265). В рамках задания предпологается запускать модель TEB в оффлайн режиме, т.е. когда характеристики атмосферы над городом задаются в качестве форсинга.
